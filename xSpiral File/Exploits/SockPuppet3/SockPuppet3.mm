//
//  SockPuppet3.m
//  Created on 9/19/19
//

#import "SockPuppet3.h"
#import "SockPuppet.hpp"

@implementation SockPuppet3

static Exploits::SockPuppet *exploit;

+ (BOOL)run {
    static BOOL hasRun = FALSE;
    static BOOL result = FALSE;

    if (hasRun) {
        return result;
    }

    static dispatch_once_t onceToken;

    dispatch_once(&onceToken, ^{
        exploit = new Exploits::SockPuppet(HostInfo(), Parameters());
    });

    hasRun = TRUE;
    result = exploit->run();
    return result;
}

+ (mach_port_t)fakeKernelTaskPort {
    return exploit->getFakeKernelTaskPort();
}

+ (uint64_t)currentTaskAddress {
    return exploit->getCurrentTaskAddress();
}

@end
